/**
 * File:
 *  processQueue.ycp
 *
 * Module:
 *  Users configurator
 *
 * Summary:
 *  Processing todo queue test.
 *
 * Authors:
 *  Jiri Srain <jsrain@suse.cz>
 *
 * $Id$
 *
 */

{
    global define UI::OpenDialog(term t)``{}
    global define UI::CloseDialog()``{}
    global define term UI::UserInput()``{return `lprng ;}
    global define UI::SetConsoleFont (string console_magic, string font, string screen_map, string unicode_map, string encoding) ``{}
    global define UI::Recode (string s1, string s2, string s) ``{return s;}

    include "testsuite.ycp";
    import "./../src/UserWriteStack";

    map EXEC = $[
	"target" : $[
	    "bash_output" : $["exit" : 0, "stdout" : "stdout", "stderr" : "stderr"]
	]
    ];

    UserWriteStack::write_to_system_stack = [
	$[ "error":"Can't create the new user aaa",
	   "id":500,
	   "todo":"/usr/sbin/useradd -s /bin/bash -d /home/aaa -g  -m -p '$1$T8$yEI1SH.1b0jqeqDq6bHha1' -u 500 -o -c \"\" -G dialout,uucp,video,audio aaa",
	   "type":`user,
	   "what":`add_user],
	$[ "error":"Can't execute /usr/sbin/useradd.local",
	   "id":500,
	   "todo":"/usr/sbin/useradd.local aaa",
	   "type":`user,
	   "what":`add_user_local],
	$[ "error":"Can't create the new user aaa",
	   "id":500,
	   "todo":"/usr/sbin/useradd -s /bin/bash -g  -m -p '$1$T8$yEI1SH.1b0jqeqDq6bHha1' -u 500 -o -c \"\" -G dialout,uucp,video,audio aaa",
	   "type":`user,
	   "what":`add_user],
	$[ "error":"Can't execute /usr/sbin/useradd.local",
	   "id":500,
	   "todo":"/usr/sbin/useradd.local aaa",
	   "type":`user,
	   "what":`add_user_local],
	$[ "error":"Can't chown home directory",
	   "id":500,
	   "todo":"/bin/chown -R aaa: /home/aaa",
	   "type":`user,
	   "what":`chown_home]];

    TEST(``(UserWriteStack::SaveDialog (false)), [$[], $[], EXEC], 0);

}
